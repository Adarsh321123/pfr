\chapter{The Fibring lemma}

\begin{proposition}\label{projections-1}
  \uses{ruz-dist-def, cond-dist-def,conditional-mutual-def}
  Let $\pi : H \to H'$ be a homomorphism between vector spaces over $\F_2$ and let $Z_1,Z_2$ be $H$-valued random variables. Then we have
  \[
    d[Z_1; Z_2] \geq d[\pi(Z_1);\pi(Z_2)] + d[Z_1|\pi(Z_1); Z_2 |\pi(Z_2)].
  \]
  Moreover, if $Z_1,Z_2$ are taken to be independent, then the difference between the two sides is
$$I( Z_1 - Z_2 : (\pi(Z_1), \pi(Z_2))  |  \pi(Z_1 - Z_2) ).$$
\end{proposition}


\begin{proof}\uses{ruz-copy, independent-exist, submodularity}
  Let $Z_1,Z_2$ be independent throughout (this is possible by Lemma \ref{ruz-copy} and Lemma \ref{independent-exist}).  We have
  \begin{align*}
    & d[Z_1  |\pi(Z_1); Z_2 |\pi(Z_2)] \\
    & = H[ Z_1 + Z_2 | \pi(Z_1),\pi(Z_2)] - \tfrac{1}{2} H[Z_1 | \pi(Z_1)] - \tfrac{1}{2} H[Z_2 | \pi(Z_2)] \\
    & \leq  H[ Z_1 + Z_2 | \pi(Z_1+Z_2)]  - \tfrac{1}{2} \H[Z_1 | \pi(Z_1)] - \tfrac{1}{2}H[Z_2 | \pi(Z_2)] \\
    & = d[Z_1;Z_2] - d[\pi(Z_1);\pi(Z_2)].
  \end{align*}
  In the middle step, we used Lemma \ref{submodularity}, and in the last step we used the fact that
  \[ H[Z_1 + Z_2 |  \pi(Z_1+Z_2)] = H[Z_1 + Z_2] - H[\pi(Z_1+Z_2)]\]
  (since $Z_1 + Z_2$ determines $\pi(Z_1 + Z_2)$; this may need a specific entropy lemma) and that
  \[ H[Z_i| \pi(Z_i)] = H[Z_i] - H[\pi(Z_i)]\] (since $Z_i$ determines $\pi(Z_i)$).
  This gives the claimed inequality. The difference between the two sides is precisely
  \[ H[Z_1 + Z_2  | \pi(Z_1 + Z_2)] - H[Z_1 + Z_2  | \pi(Z_1),\pi(Z_2)].\]
  To rewrite this in terms of (conditional) mutual information, we use the identity
  \[ H[A|B] - H[A | B,C] = I[A : C | B],\]
  (which follows from various entropy facts including Lemma \ref{conditional-mutual-alt})
  taking
  $A \coloneqq Z_1 + Z_2$, $B \coloneqq \pi(Z_1 + Z_2)$ and $C \coloneqq (\pi(Z_1),\pi(Z_{2}))$, and noting that in this case $\H{A | B,C} = \H{A | C}$ since $C$ uniquely determines $B$.
  This completes the proof.
\end{proof}
